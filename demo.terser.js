//! ZzFXM (v2.0.3) | (C) Keith Clark | MIT | https://github.com/keithclark/ZzFXM
zzfxM=(t,e,i,o=125)=>{let r,a,n,h,s,l,f,d,c,z,g,x,M,u,P,p=0,m=[],w=[],I=[],y=0,R=0,S=1,C={},T=zzfxR/o*60>>2;for(;S;y++)m=[S=d=g=M=0],i.map(((o,g)=>{for(f=e[o][y]||[0,0,0],S|=!!e[o][y],P=M+(e[o][0].length-2-!d)*T,u=g==i.length-1,a=2,h=M;a<f.length+u;d=++a){for(s=f[a],c=a==f.length+u-1&&u||z!=(f[0]||0)|s|0,n=0;n<T&&d;n++>T-99&&c?x+=(x<1)/99:0)l=(1-x)*m[p++]/2||0,w[h]=(w[h]||0)-l*R+l,I[h]=(I[h++]||0)+l*R+l;s&&(x=s%1,R=f[1]||0,(s|=0)&&(m=C[[z=f[p=0]||0,s]]=C[[z,s]]||(r=[...t[z]],r[2]*=2**((s-12)/12),s>0?zzfxG(...r):[])))}M=P}));return[w,I]},zzfx=(...t)=>zzfxP(zzfxG(...t)),zzfxP=(...t)=>{let e=zzfxX.createBufferSource(),i=zzfxX.createBuffer(t.length,t[0].length,zzfxR);return t.map(((t,e)=>i.getChannelData(e).set(t))),e.buffer=i,e.connect(zzfxX.destination),e.start(),e},zzfxG=(t=1,e=.05,i=220,o=0,r=0,a=.1,n=0,h=1,s=0,l=0,f=0,d=0,c=0,z=0,g=0,x=0,M=0,u=1,P=0,p=0)=>{let m,w,I=2*Math.PI,y=s*=500*I/zzfxR**2,R=(0<g?1:-1)*I/4,S=i*=(1+2*e*Math.random()-e)*I/zzfxR,C=[],T=0,b=0,v=0,k=1,L=0,A=0,D=0;for(o=99+zzfxR*o,P*=zzfxR,r*=zzfxR,a*=zzfxR,M*=zzfxR,l*=500*I/zzfxR**3,g*=I/zzfxR,f*=I/zzfxR,d*=zzfxR,c=zzfxR*c|0,w=o+P+r+a+M|0;v<w;C[v++]=D)++A%(100*x|0)||(D=n?1<n?2<n?3<n?Math.sin((T%I)**3):Math.max(Math.min(Math.tan(T),1),-1):1-(2*T/I%2+2)%2:1-4*Math.abs(Math.round(T/I)-T/I):Math.sin(T),D=(c?1-p+p*Math.sin(2*Math.PI*v/c):1)*(0<D?1:-1)*Math.abs(D)**h*t*zzfxV*(v<o?v/o:v<o+P?1-(v-o)/P*(1-u):v<o+P+r?u:v<w-M?(w-v-M)/a*u:0),D=M?D/2+(M>v?0:(v<w-M?1:(w-v)/M)*C[v-M|0]/2):D),m=(i+=s+=l)*Math.sin(b*g-R),T+=m-m*z*(1-1e9*(Math.sin(v)+1)%2),b+=m-m*z*(1-1e9*(Math.sin(v)**2+1)%2),k&&++k>d&&(i+=f,S+=f,k=0),!c||++L%c||(i=S,s=y,k=k||1);return C},zzfxV=.3,zzfxR=44100,zzfxX=new(window.AudioContext||webkitAudioContext);class Vector{constructor(t,e){this.x=t,this.y=e}}const songData=[[[.4,0,4e3,,,.03,2,1.25,,,,,.02,6.8],[,0,655,,,.11,2,1.65,,,,,,3.8,-.1,.1],[2.9,0,52,,,.13,,2.9,-1.1,4,156,15,,4.2],[3.3,0,58,,,.06,,5.9,,,,,,1,,.2,.004],[3.3,0,58,,,.15,,5.9,,,,,,1,,.2,.003],[2.1,0,100,2,1.42,3,,5.9,,,,,,1,20,-.2,.9],[3.3,0,58,,,.18,,5.9,,,,,,1,,.2,.007],[3.3,0,58,,,.08,,9.7,,,,,,1,,.2,.009],[3.3,0,58,,,.14,,8,,,,,,1,,.3,.13],[3.3,0,58,,,,,6.8,,,,,,1,,.2,.005],[3.3,0,58,,,.11,,5,,,,,,1,,.3,.006],[3.3,0,58,,,.14,,12,,,,,,1,,.4,.02],[3.3,0,58,,,.14,,19,,,,,,1,,.3,.004],[3.3,0,58,,,.11,,15.6,,,,,,1,,-.3,.005],[3.3,0,58,,,,,30,,,,,,1,,-.3,.01],[3.3,0,58,,,.12,,6,,,,,,1,,-.4,.006],[.5,0,2001,,,,3,5.3,,,-400,,,2],[3.3,0,58,,,.16,,6,,,,,,1,,-.4,.003],[.7,0,600,,,2.97,4,5,,,60,,.3,4,30,.01,.3,,,1],[3.3,0,58,,,.16,,13,,,,,,1,,-.4,.005],[3.3,0,58,,,.13,,6,,,,,,1,,.6,.13]],[[[,,26,32,34,32,1,18,,,,,24,27,,20,25,,],[5,,1,,,,,,,,,,,,,,,,]],[[,,17,32,34,32,1,18,,,,,24,27,,20,25,1],[1,,,,,,32,,,,,,,,32,,,,],[5,,1,,,,,,,,,,,,,,,,]],[[,,17,32,34,32,1,18,,,,,24,27,,,,,],[1,,,,,,32,,,,,,,,32,,,,],[2,,18,18,,,,,18,18,,,18,,,,18,,],[4,,23,26,,14,,,11,,23,26,,14,,11,27,,]],[[4,,23,26,,14,,,11,,23,26,,14,,11,27,,]],[[,,17,32,34,32,1,18,32,1,27,34,24,27,18,24,18,6],[6,,23,26,,14,,,11,,23,26,,14,,11,27,,]],[[,,17,32,34,32,1,18,32,1,27,34,24,27,18,24,18,6],[7,,23,26,,14,,,11,,23,26,,14,,11,27,,]],[[8,,23,26,,14,,,11,,23,26,,14,,11,27,,],[1,,32.99,32.9,32.84,32.79,32.74,32.69,32.64,32.58,32.53,32.49,32.44,32.4,32.35,32.3,32.25,32.2]],[[,,17,32,34,32,1,18,32,1,27,34,24,27,18,24,18,6],[9,,20,26,,14,,,11,,23,26,,14,,11,27,,]],[[,,17,32,34,32,1,18,32,1,27,34,24,27,18,24,18,6],[10,,23,26,,14,,,11,,23,26,,14,,11,27,,]],[[,,17,32,34,32,1,18,32,1,27,34,24,27,18,24,18,6],[1,,,,,,32,,,,,,,,32,,,,],[2,,18,,,,,,18,18,,,,,,,18,,],[9,,23,26,,14,,,11,,23,26,,14,,11,27,,],[18,,18,,,,,,,,,,,,,,,,]],[[,,17,32,34,32,1,18,32,1,27,34,24,27,18,24,18,6],[1,,,,,,32,,,,,,,,32,,,,],[2,,18,,,,,,18,18,,,,,,,18,,],[10,,23,26,2,14,,,11,,23,26,2,14,,11,27,,]],[[,,17,32,34,32,1,18,32,1,27,34,24,27,18,24,18,6],[1,,,,,,32,,,,,,,,32,,,,],[2,,18,,,,,,18,18,,,,,,,18,,],[11,,23,26,,14,,2,11,,23,26,,14,,11,27,15]],[[,,17,32,34,32,1,18,32,1,27,34,24,27,,,,,],[1,,,,,,32,,,32.6,,32.4,,,32,,32,32],[2,,18,,,,,,18,,,,18,,,,,,],[12,,23,26,2,14,,2,11,2,23,26,2,14,3,11,27,15]],[[,,17,32,34,32,1,18,32,1,27,34,24,27,18,24,18,6],[1,,,,,,32,,,,,,,,32,,,,],[2,,18,18,,,,,18,18,,,18,,,,18,,],[13,,23,26,2,14,,2,11,,23,26,2,14,,11,27,15],[16,,,,24,,,,24,,,,24,,,,24,,],[18,,18,,,,,,,,,,,,,,,,]],[[,,17,32,34,32,1,18,32,1,27,34,24,27,18,24,18,6],[1,,,,,,32,,,,,,,,32,,,,],[2,,18,18,,,,,18,18,,,18,,,,18,,],[15,,23,26,2,14,,2,11,,23,26,2,14,,11,27,15],[16,,,,24,,,,24,,,,24,,,,24,,]],[[,,17,32,34,32,1,18,32,1,27,34,24,27,18,24,18,6],[1,,,,,,32,,,,,,,,32,,,,],[2,,18,,,18,,,,18,,18,18,,,,18,,],[17,,23,26,2,14,,2,11,,23,26,2,14,,11,27,15],[16,,,,24,,,,24,,,,24,,,,24,,]],[[,,17,32,34,32,1,18,,,,,24,27,,,,,],[1,,,,,,32,,,,,,,,32,,,,],[2,,18,,,,,,18,18,,,,,,,18,,],[3,,23,26,,14,,,11,,23,26,,14,,11,27,,],[18,,,,,,1,,,,,,,,,,,,]],[[,,17,32,34,32,1,18,32,1,27,34,24,27,18,24,18,6],[1,,,,,,32,,,,,,,,32,,,,],[2,,18,18,,,,,18,18,,,18,,,,18,,],[12,,23,26,2,14,,2,11,,23,26,2,14,,11,27,15],[16,,,,24,,,,24,,,,24,,,,24,,]],[[,,17,32,34,32,1,18,32,1,27,34,24,27,18,24,18,6],[1,,,,,,32,,,,,,,,32,,,,],[2,,18,,,18,,,,18,,18,18,,,,18,,],[19,,23,26,2,14,,2,11,,23,26,2,14,,11,27,15],[16,,,,24,,,,24,,,,24,,,,24,,]],[[14,,23,26,2,14,,2,11,,23,26,2,14,,11,27,15],[16,,,,24,,,,24,,,,24,,,,24,,],[1,,32.99,32.9,32.84,32.79,32.74,32.69,32.64,32.58,32.53,32.49,32.44,32.4,32.35,32.3,32.25,32.2]],[[10,,23,26,,14,,,11,,23,26,,14,,11,27,,],[5,,1,,,,,,,,,,,,,,,,],[18,,1,,,,,,,,,,,,,,,,]],[[15,,23,26,,14,,,11,,23,26,,14,,11,27,,]],[[20,,23,26,,14,,,11,,23,26,,14,,11,27,,]],[[8,,23,26,,14,,,11,,23,26,,14,,11,27,,]]],[0,1,16,2,3,7,4,5,8,6,9,10,11,12,13,14,15,17,18,19,20,21,23,22],,{title:"arsembley",instruments:["Hihat","Claps","Bass Drum 2","synth","I4","I5","I7","I9","I11","I12","I14","I15","I17","I18","I19","I20","Hihat Open","I22","Dig Dug","I24","I26"],patterns:["P0","P2","P7","P11","P13","P15","P17","P18","P20","P21","P26","P27","P28","P30","P31","P32","P37","P38","P39","P41","P42","P44","P46","P47"]}],cS=20,w=20*Math.floor(window.innerWidth/20),h=20*Math.floor(window.innerHeight/20),grid=new Vector(Math.floor(w/20),Math.floor(h/20)),texts=["2","0","2","3","2023","ASSEMBLY",String.fromCodePoint(10084)];let cT=0,fd=[],rot=0;class Particle{constructor(){this.reset()}reset(){for(let t=0;t<10&&(this.pos=new Vector(Math.floor(Math.random()*w),Math.floor(Math.random()*h)),!fd[Math.floor(this.pos.y/20)*grid.x+Math.floor(this.pos.x/20)]);t++);this.velocityMultiplier=Math.floor(1+4*Math.random()),this.curve=Math.random()*Math.PI/10,this.trail=[{...this.pos}],this.trailLen=Math.floor(10+20*Math.random()),this.angle=rot,this.lightness=12}draw(t){const e=cT===texts.length?0:this.angle/(2*Math.PI)*360;t.strokeStyle=`hsl(${e}, 100%, ${this.lightness}%)`;for(let e=1;e<this.trail.length;e++){const i=this.trail[e-1],o=this.trail[e];t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(o.x,o.y),t.stroke()}}update(){if(this.trail.length===this.trailLen)return this.trail.shift(),this.trailLen--,void(0===this.trailLen&&this.reset());const t=fd[Math.floor(this.pos.y/20)*grid.x+Math.floor(this.pos.x/20)];for(this.lightness=t?60:12,this.angle>t?this.angle-=this.curve:this.angle<t?this.angle+=this.curve:this.angle=t,this.pos.x+=Math.cos(this.angle+rot)*this.velocityMultiplier,this.pos.y+=Math.sin(this.angle+rot)*this.velocityMultiplier,this.trail.push({...this.pos});this.trail.length>this.trailLen;)this.trail.shift()}}let demoStarted=!1;function demo(){if(demoStarted)return;demoStarted=!0;const t=zzfxM(...songData);zzfxP(...t);let e=[];const i=document.getElementById("c");let o=i.getContext("2d",{willReadFrequently:!0});i.width=w,i.height=h,o.strokeStyle="white",o.lineWidth=2/1920*w;const r=o.createRadialGradient(w/2,h/2,h/20,w/2,h/2,w);function a(){cT!==texts.length?(o.fillText(texts[cT],w/2,h/2,w),cT++):i.classList.add("fade")}function n(){let t=[];const e=o.getImageData(0,0,w,h).data;for(let i=0;i<h;i+=20)for(let o=0;o<w;o+=20){const r=4*(i*w+o),a=(e[r]+e[r+1]+e[r+2])/3;t.push(a/255*Math.PI*2)}fd=t}r.addColorStop(0,"red"),r.addColorStop(.25,"orange"),r.addColorStop(.5,"yellow"),r.addColorStop(.75,"green"),r.addColorStop(1,"blue"),o.fillStyle=r,o.font=`bold ${h}px Arial`,o.textBaseline="middle",o.textAlign="center",a(),n(),setInterval((()=>{a(),n()}),6e3);for(let t=0;t<1e3;t++)e.push(new Particle);const s=()=>{o.clearRect(0,0,w,h),e.forEach((t=>{t.update(fd),t.draw(o)})),rot+=Math.PI/360,requestAnimationFrame(s)};s()}const clickTrigger=document.createElement("p");clickTrigger.textContent="Click to start",clickTrigger.setAttribute("style","color:#FFF;text-align:center;font-size:100px;text-transform:uppercase;font-weight:bold;pointer-events:none;"),document.body.addEventListener("click",(()=>{clickTrigger.remove(),demo()})),document.body.appendChild(clickTrigger);