let zzfxM=(a,i,l,t=125)=>{let r,n,o,h,s,c,f,z,x,d,u,g,M,p,w=0,S=[],m=[],P=[],v=0,y=0,R=1,C={},T=zzfxR/t*60>>2;for(;R;v++)S=[R=z=g=0],l.map((t,e)=>{for(f=i[t][v]||[0,0,0],R|=!!i[t][v],p=g+(i[t][0].length-2-!z)*T,M=e==l.length-1,n=2,h=g;n<f.length+M;z=++n){for(s=f[n],x=n==f.length+M-1&&M||d!=(f[0]||0)|s|0,o=0;o<T&&z;o++>T-99&&x&&(u+=(u<1)/99))c=(1-u)*S[w++]/2||0,m[h]=(m[h]||0)-c*y+c,P[h]=(P[h++]||0)+c*y+c;s&&(u=s%1,y=f[1]||0,s|=0)&&(S=C[[d=f[w=0]||0,s]]=C[[d,s]]||((r=[...a[d]])[2]*=2**((s-12)/12),0<s?zzfxG(...r):[]))}g=p});return[m,P]};const zzfx=(...t)=>zzfxP(zzfxG(...t)),zzfxV=.3,zzfxR=44100,zzfxX=new(window.AudioContext||webkitAudioContext),zzfxP=(...t)=>{let a=zzfxX.createBuffer(t.length,t[0].length,zzfxR),e=zzfxX.createBufferSource();return t.map((t,e)=>a.getChannelData(e).set(t)),e.buffer=a,e.connect(zzfxX.destination),e.start(),e},zzfxG=(t=1,e=.05,a=220,i=0,l=0,r=.1,n=0,o=1,h=0,s=0,c=0,f=0,z=0,x=0,d=0,u=0,g=0,M=1,p=0,w=0)=>{let S=2*Math.PI,m=h*=500*S/zzfxR/zzfxR,P=a*=(1+2*e*Math.random()-e)*S/zzfxR,v=[],y=0,R=0,C=0,T=1,b=0,I=0,F=0,A,L;for(i=i*zzfxR+9,p*=zzfxR,l*=zzfxR,r*=zzfxR,g*=zzfxR,s*=500*S/zzfxR**3,d*=S/zzfxR,c*=S/zzfxR,f*=zzfxR,z=z*zzfxR|0,L=i+p+l+r+g|0;C<L;v[C++]=F)++I%(100*u|0)||(F=n?1<n?2<n?3<n?Math.sin((y%S)**3):Math.max(Math.min(Math.tan(y),1),-1):1-(2*y/S%2+2)%2:1-4*Math.abs(Math.round(y/S)-y/S):Math.sin(y),F=(z?1-w+w*Math.sin(S*C/z):1)*(0<F?1:-1)*Math.abs(F)**o*t*zzfxV*(C<i?C/i:C<i+p?1-(C-i)/p*(1-M):C<i+p+l?M:C<L-g?(L-C-g)/r*M:0),F=g?F/2+(g>C?0:(C<L-g?1:(L-C)/g)*v[C-g|0]/2):F),A=(a+=h+=s)*Math.cos(d*R++),y+=A-A*x*(1-1e9*(Math.sin(C)+1)%2),T&&++T>f&&(a+=c,P+=c,T=0),!z||++b%z||(a=P,h=m,T=T||1);return v};class Vector{constructor(t,e){this.x=t,this.y=e}}const songData=[[[.4,0,4e3,,,.03,2,1.25,,,,,.02,6.8,-.3],[,0,655,,,.11,2,1.65,,,,,,3.8,-.1,.1],[3,0,43,,,.17,,3,-1.3,,160,.2,,2.2,200],[3.3,0,58,,,.06,,5.9,,,,,,1,,.2],[3.3,0,58,,,.15,,5.9,,,,,,1,,.2]],[[[,,1,32,34,32,1,18,,24,22,1,24,27,,20,25,,],[1,,,,,,,,32,,,,,,32,,,,]],[[,,1,32,34,32,1,18,,24,22,1,24,27,,,,,],[1,,,,,,,,32,,,,,,32,,,,]],[[,,1,32,34,32,1,18,,24,22,1,24,,,,,,],[1,,,,,,,,32,,,,,32,32,32,32,,]],[[,,1,32,34,32,1,18,,24,22,1,24,27,,20,25,,],[1,,,,,,,,32,,,,,,32,,,,],[2,,18,,,18,,,,,,,18,,,,18,,]],[[,,1,32,34,32,1,18,,24,22,1,24,27,,,,,],[1,,,,,,,,32,,,,,,32,32,,,],[2,,18,,,18,,,,,,,18,,,,18,,]],[[,,1,32,34,32,1,18,,24,22,1,24,27,,,,,],[1,,,,,,,,32,,,,,,32,,,,],[2,,18,,,18,,,,,,,18,,,,,,]],[[,,1,32,34,32,1,18,,24,22,1,24,27,,20,25,,],[1,,,,,,,,32,,,,,,32,,,,],[2,,18,,,18,,,,,,,18,,,,18,,],[3,,23,26,,14,,,11,,23,26,,14,,11,27,,],[,,8,,,,,,,,,,,,,,,,]],[[,,1,32,34,32,1,18,,24,22,1,24,27,,20,25,,],[1,,,,,,,,32,,,,,,32,,,,],[2,,18,,,18,,,,,,,18,,,,18,,],[4,,23,26,,14,,,11,,23,26,,14,,11,27,,],[,,8,,,,,,,,,,,,,,,,]]],[0,1,0,2,3,4,3,5,6,6,6,7,6,6,6,7],,{title:"paskaa",instruments:["Hihat","Claps","Bass Drum 2","synth","Instrument 4"],patterns:["Pattern 0","Pattern 1","Pattern 2","Pattern 3","Pattern 4","Pattern 5","Pattern 6","Pattern 7"]}],buffer=zzfxM(...songData);let myAudio=zzfxP(...buffer);const cellSize=20,w=Math.floor(window.innerWidth/cellSize)*cellSize,h=Math.floor(window.innerHeight/cellSize)*cellSize,zoom=.15,curve=.8,grid=new Vector(Math.floor(w/cellSize),Math.floor(h/cellSize)),rotateCos=Math.cos(Math.PI/9e3),rotateSin=Math.sin(Math.PI/9e3);let field=[],rotate=0;class Particle{constructor(){this.reset()}reset(){for(let t=0;t<20&&(this.pos=new Vector(Math.floor(Math.random()*w),Math.floor(Math.random()*h)),!field[Math.floor(this.pos.y/cellSize)*grid.x+Math.floor(this.pos.x/cellSize)]);t++);this.velocityMultiplier=Math.floor(1+4*Math.random()),this.curve=Math.random()*Math.PI/10,this.trail=[{...this.pos}],this.trailLen=Math.floor(10+10*Math.random()),this.angle=rotate,this.lightness=12}draw(e){var t=currentText===texts.length?0:this.angle/(2*Math.PI)*360;e.strokeStyle=`hsl(${t}, 100%, ${this.lightness}%)`;for(let t=1;t<this.trail.length;t++){var a=this.trail[t-1],i=this.trail[t];e.beginPath(),e.moveTo(a.x,a.y),e.lineTo(i.x,i.y),e.stroke()}}update(){if(this.trail.length===this.trailLen)this.trail.shift(),this.trailLen--,0===this.trailLen&&this.reset();else{var t=field[Math.floor(this.pos.y/cellSize)*grid.x+Math.floor(this.pos.x/cellSize)];for(this.lightness=t?70:12,this.angle>t?this.angle-=this.curve:this.angle<t?this.angle+=this.curve:this.angle=t,this.pos.x+=Math.cos(this.angle+rotate)*this.velocityMultiplier,this.pos.y+=Math.sin(this.angle+rotate)*this.velocityMultiplier,this.trail.push({...this.pos});this.trail.length>this.trailLen;)this.trail.shift()}}}let ctx,particles=[];const canvas=document.createElement("canvas"),gradient=(ctx=canvas.getContext("2d",{willReadFrequently:!0}),canvas.width=w,canvas.height=h,document.body.appendChild(canvas),ctx.strokeStyle="white",ctx.lineWidth=2,ctx.createRadialGradient(w/2,h/2,h/cellSize,w/2,h/2,w)),texts=(gradient.addColorStop(0,"red"),gradient.addColorStop(.25,"orange"),gradient.addColorStop(.5,"yellow"),gradient.addColorStop(.75,"green"),gradient.addColorStop(1,"blue"),ctx.fillStyle=gradient,ctx.font=`bold ${h}px Arial`,ctx.textBaseline="middle",ctx.textAlign="center",["2","0","2","3","2023","ASSEMBLY",String.fromCodePoint(10084)]);let currentText=0;function updateText(){currentText!==texts.length&&(console.log(texts[currentText]),ctx.fillText(texts[currentText],w/2,h/2,w),currentText++)}function updateFlowField(){var a=[],i=ctx.getImageData(0,0,w,h).data;for(let e=0;e<h;e+=cellSize)for(let t=0;t<w;t+=cellSize){var l=4*(e*w+t),l=(i[l]+i[1+l]+i[2+l])/3;a.push(l/255*Math.PI*2)}field=a}updateText(),updateFlowField(),setInterval(()=>{updateText(),updateFlowField()},6e3);for(let t=0;t<1500;t++)particles.push(new Particle);const play=()=>{ctx.clearRect(0,0,w,h),particles.forEach(t=>{t.update(field),t.draw(ctx)}),rotate+=Math.PI/180,requestAnimationFrame(play)};play();